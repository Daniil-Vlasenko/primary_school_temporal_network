geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
vertices$transitivity <- V(network)$transitivity
(vertices %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- edges %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
vertices %>% filter(name %in% V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
vertices %>% filter(name %in% V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
which.min(V(network)$degree
which.min(V(network)$degree
which.min(V(network)$degree)
V(network)[78]
vertices[78,]
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers", "1A")]$name),
layout=layout_in_circle)
igraph_options(vertex.label=name)
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers")]$name),
layout=layout_in_circle)
(vertices %>% arrange(-degree))[1:10,]
(vertices %>% arrange(degree))[1:10,]
(vertices %>% arrange(degree))[1:10,]$name
plot(subgraph(network, (vertices %>% arrange(degree))[1:10,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:20,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:50,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:50,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.9)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=20)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=10, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.font=1)
library(dplyr)
library(igraph)
library(tidyr)
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
data1 <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
network <- graph_from_data_frame(data1, directed=FALSE, vertices=data2)
network
V(network)$sex[V(network)$sex == "Unknown"] <- NA
V(network)$sex[1:50]
V(network)$class[1:50]
E(network)$Freq[1:50]
is_connected(network)
V(network)$degree <- degree(network)
V(network)$degree[1:50]
print(paste("Mean of sample:", mean(V(network)$degree)))
print(paste("Variance of sample:", var(V(network)$degree)))
print(paste("Median of sample:", median(V(network)$degree)))
print(paste("Min of sample:", min(V(network)$degree)))
print(paste("Max of sample:", max(V(network)$degree)))
library(ggplot2)
vertices <- igraph::as_data_frame(network, what="vertices")
vertices %>%
ggplot(aes(x=degree)) +
geom_histogram(aes(y=..density..))
library(nortest)
print(paste("Pearson", pearson.test(vertices$degree)$p))
print(paste("Lilliefors", lillie.test(vertices$degree)$p))
print(paste("Anderson.Darling", ad.test(vertices$degree)$p))
print(paste("Shapiro.Wilk", shapiro.test(vertices$degree)$p))
count.of.teachers <- vertices %>% filter(class == "Teachers") %>% nrow()
(vertices %>% arrange(-degree))[1:count.of.teachers,]
edge_density(network)
class <- unique(V(network)$class)
for(i in class) {
subgraph <- induced_subgraph(network, V(network)[class == i])
print(paste("density of", i, ":", edge_density(subgraph)))
}
edges <- as_long_data_frame(network) %>%
mutate(from = as.character(from), to = as.character(to))
tmp <- data.frame(to = edges$from, from = edges$to, Freq = edges$Freq,
to_class = edges$from_class, from_class = edges$to_class)
tmp <- rbind(edges %>% select(from, to, Freq, to_class, from_class), tmp)
tmp %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
mean_distance(network)
max(distances(network))
transitivity(network)
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
vertices$transitivity <- V(network)$transitivity
(vertices %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- edges %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
# cor(data.prob$from_degree, data.prob$to_degree, method="pearson")
# cor(data.prob$from_degree, data.prob$to_degree, method="spearman")
for(i in V(network)[V(network)$class == "Teachers"]) {
print(paste0("neighbors of the teacher with id ", i, ":"))
print(table(neighbors(network, i)$class))
}
igraph_options(vertex.size=5, vertex.label.font=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.font=5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.font=0.1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.font=0.001)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.font=0.000001)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.000001)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.01)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=0)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=4)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=0.5)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=0)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
pi
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=3*pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1, vertex.label.degree=3*pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=3*pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=10, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=3*pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8, vertex.label.cex=0.5, vertex.label.dist=1.5, vertex.label.degree=3*pi/2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1,
edge.curved=0.3)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1,
edge.curved=0)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
plot(network,
layout=layout_with_fr)
igraph_options(vertex.size=1,
vertex.label=NA
edge.width=1)
plot(network,
layout=layout_with_fr)
igraph_options(vertex.size=1,
vertex.label=NA,
edge.width=1)
plot(network,
layout=layout_with_fr)
plot(network,
layout=layout_with_fr)
plot(network,
layout=layout_with_kk)
plot(network,
layout=layout_with_kk)
plot(network, layout=layout_with_kk)
help(layout)
help(layout)
plot(network, layout=component_wise)
igraph_options(vertex.size=1,
vertex.label=NA,
edge.width=1)
plot(network, layout=layout_as_bipartite)
plot(network, layout=layout_as_star)
plot(network, layout=layout_nicely)
plot(network, layout=layout_on_grid)
plot(network, layout=layout_on_grid(dim=3))
plot(network, layout=layout_on_grid, dim =3
plot(network, layout=layout_on_grid, dim =3)
plot(network, layout=layout_on_grid, dim =3)
plot(network, layout=layout_on_sphere)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name), layout=layout_on_sphere)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_with_dh)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_with_dh)
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
gc()
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
library(dplyr)
library(igraph)
library(tidyr)
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
data1 <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
network <- graph_from_data_frame(data1, directed=FALSE, vertices=data2)
network
V(network)$sex[V(network)$sex == "Unknown"] <- NA
V(network)$sex[1:50]
V(network)$class[1:50]
E(network)$Freq[1:50]
is_connected(network)
V(network)$degree <- degree(network)
V(network)$degree[1:50]
print(paste("Mean of sample:", mean(V(network)$degree)))
print(paste("Variance of sample:", var(V(network)$degree)))
print(paste("Median of sample:", median(V(network)$degree)))
print(paste("Min of sample:", min(V(network)$degree)))
print(paste("Max of sample:", max(V(network)$degree)))
library(ggplot2)
vertices <- igraph::as_data_frame(network, what="vertices")
vertices %>%
ggplot(aes(x=degree)) +
geom_histogram(aes(y=..density..))
library(nortest)
print(paste("Pearson", pearson.test(vertices$degree)$p))
print(paste("Lilliefors", lillie.test(vertices$degree)$p))
print(paste("Anderson.Darling", ad.test(vertices$degree)$p))
print(paste("Shapiro.Wilk", shapiro.test(vertices$degree)$p))
count.of.teachers <- vertices %>% filter(class == "Teachers") %>% nrow()
(vertices %>% arrange(-degree))[1:count.of.teachers,]
edge_density(network)
class <- unique(V(network)$class)
for(i in class) {
subgraph <- induced_subgraph(network, V(network)[class == i])
print(paste("density of", i, ":", edge_density(subgraph)))
}
edges <- as_long_data_frame(network) %>%
mutate(from = as.character(from), to = as.character(to))
tmp <- data.frame(to = edges$from, from = edges$to, Freq = edges$Freq,
to_class = edges$from_class, from_class = edges$to_class)
tmp <- rbind(edges %>% select(from, to, Freq, to_class, from_class), tmp)
tmp %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
mean_distance(network)
max(distances(network))
transitivity(network)
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
vertices$transitivity <- V(network)$transitivity
(vertices %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- edges %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
# cor(data.prob$from_degree, data.prob$to_degree, method="pearson")
# cor(data.prob$from_degree, data.prob$to_degree, method="spearman")
for(i in V(network)[V(network)$class == "Teachers"]) {
print(paste0("neighbors of the teacher with id ", i, ":"))
print(table(neighbors(network, i)$class))
}
igraph_options(vertex.size=8,
vertex.label.cex=0.5,
vertex.label.dist=1.5,
vertex.label.degree=3*pi/2,
edge.width=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
