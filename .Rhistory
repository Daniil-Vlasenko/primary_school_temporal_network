axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
mean_distance(network)
max(distances(network))
transitivity(network)
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
data.v$transitivity <- V(network)$transitivity
(data.v %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- data.e %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
# cor(data.prob$from_degree, data.prob$to_degree, method="pearson")
# cor(data.prob$from_degree, data.prob$to_degree, method="spearman")
for(i in V(network)[V(network)$class == "Teachers"]) {
print(paste0("neighbors of the teacher with id ", i, ":"))
print(table(neighbors(network, i)$class))
}
plot(network, layout=layout_in_circle)
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
plot(network, layout=layout_in_circle)
igraph_options(vertex.size=1, vertex.label=NA,
edge.arrow.size=0.1)
plot(network, layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.1)
plot(network, layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=1)
plot(network, layout=layout_in_circle)
igraph_options(vertex.label=NA)
plot(network, layout=layout_in_circle)
library(dplyr)
library(igraph)
library(tidyr)
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
edges <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
network <- graph_from_data_frame(edges, directed=FALSE, vertices=data2)
network
V(network)$sex[V(network)$sex == "Unknown"] <- NA
V(network)$sex[1:50]
V(network)$class[1:50]
E(network)$Freq[1:50]
is_connected(network)
V(network)$degree <- degree(network)
V(network)$degree[1:50]
print(paste("Mean of sample:", mean(V(network)$degree)))
print(paste("Variance of sample:", var(V(network)$degree)))
print(paste("Median of sample:", median(V(network)$degree)))
print(paste("Min of sample:", min(V(network)$degree)))
print(paste("Max of sample:", max(V(network)$degree)))
library(ggplot2)
data.v <- data.frame(name=V(network)$name,
class=as.factor(V(network)$class),
degree=V(network)$degree)
data.v %>%
ggplot(aes(x=degree)) +
geom_histogram(aes(y=..density..))
library(nortest)
print(paste("Pearson", pearson.test(data.v$degree)$p))
print(paste("Lilliefors", lillie.test(data.v$degree)$p))
print(paste("Anderson.Darling", ad.test(data.v$degree)$p))
print(paste("Shapiro.Wilk", shapiro.test(data.v$degree)$p))
count.of.teachers <- data.v %>% filter(class == "Teachers") %>% nrow()
(data.v %>% arrange(-degree))[1:count.of.teachers,]
edge_density(network)
class <- unique(V(network)$class)
for(i in class) {
subgraph <- induced_subgraph(network, V(network)[class == i])
print(paste("density of", i, ":", edge_density(subgraph)))
}
data.e <- as_long_data_frame(network) %>%
mutate(from = as.character(from), to = as.character(to))
tmp <- data.frame(to = data.e$from, from = data.e$to, Freq = data.e$Freq,
to_class = data.e$from_class, from_class = data.e$to_class)
tmp <- rbind(data.e %>% select(from, to, Freq, to_class, from_class), tmp)
tmp %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
mean_distance(network)
max(distances(network))
transitivity(network)
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
data.v$transitivity <- V(network)$transitivity
(data.v %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- data.e %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
# cor(data.prob$from_degree, data.prob$to_degree, method="pearson")
# cor(data.prob$from_degree, data.prob$to_degree, method="spearman")
for(i in V(network)[V(network)$class == "Teachers"]) {
print(paste0("neighbors of the teacher with id ", i, ":"))
print(table(neighbors(network, i)$class))
}
igraph_options(vertex.label=NA)
plot(network, layout=layout_in_circle)
# CHUNK 1
library(sand)
g.l <- make_lattice(c(5, 5, 5))
# CHUNK 2
data(aidsblog)
summary(aidsblog)
# CHUNK 3
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
par(mfrow=c(1, 2))
plot(g.l, layout=layout_in_circle)
g.l <- make_lattice(c(10, 10, 10))
# CHUNK 2
data(aidsblog)
summary(aidsblog)
# CHUNK 3
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
par(mfrow=c(1, 2))
plot(g.l, layout=layout_in_circle)
5
plot(aidsblog, layout=layout_in_circle)
g.l <- make_lattice(c(5, 5, 5))
# CHUNK 2
data(aidsblog)
summary(aidsblog)
# CHUNK 3
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
par(mfrow=c(1, 2))
plot(g.l, layout=layout_in_circle)
title("5x5x5 Lattice")
plot(aidsblog, layout=layout_in_circle)
title("Blog Network")
# CHUNK 3
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.1)
plot(aidsblog, layout=layout_in_circle)
V$class
V(network)
V(network)$class
[V(network)$class == "4B" ]
V(network)[V(network)$class == "4B" ]
V(network)[V(network)$class == "4B" ]$name
subgraph(network, V(network)[V(network)$class == "4B" ]$name)
plot(subgraph(network, V(network)[V(network)$class == "4B" ]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class == "4B" ]$name)[1:10],
layout=layout_in_circle)
subgraph(network, V(network)[V(network)$class == "4B" ]$name)
subgraph(network, V(network)[V(network)$class == "4B" ]$name[1:10])
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[1:10]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[1:10]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[1:10]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[1:10]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[1:10]) +
subgraph(network, V(network)[V(network)$class=="5A"]$name[1:10]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[1:10]) +
subgraph(network, V(network)[V(network)$class=="5A"]$name[1:10]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="5A"]$name[1:10]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="5A"]$name[10:20]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class=="4B"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="4A"]$name[10:20]) +
subgraph(network, V(network)[V(network)$class=="Teachers"]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("4B", "4A")]$name[10:20]),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("4B", "4A")]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("4B", "Teachers")]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers")]$name),
layout=layout_in_circle)
"4B",
e
plot(subgraph(network, V(network)[V(network)$class %in% c("4B", "4A")]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("5B", "1A")]$name),
layout=layout_in_circle)
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers", "1A")]$name),
layout=layout_in_circle)
V(network)$degree
order(V(network)$degree)
arrange(V(network)$degree)
arrange(V(network)$degree)
V(network)$degree
min(V(network)$degree)
hwich.min(V(network)$degree)
which.min(V(network)$degree)
V(network)[V(network)$name == which.min(V(network)$degree)]
which.min(V(network)$degree)
V(network)[V(network)$degree == which.min(V(network)$degree)]
V(network)[V(network)$degree == which.min(V(network)$degree)]
V(network)[V(network)$degree == which.min(V(network)$degree)]
which.min(V(network)$degree)
V(network)[V(network)$degree == which.min(V(network)$degree)]
print_all(V(network)[V(network)$degree == which.min(V(network)$degree)]
print_all(V(network)[V(network)$degree == which.min(V(network)$degree)]
print_all(V(network)[V(network)$degree == which.min(V(network)$degree)])
V(network)[V(network)$degree == which.min(V(network)$degree)]
V(network)[V(network)$degree == which.min(V(network)$degree)]
vertex_attr(network, "1564")
V(network)[V(network)$degree == which.min(V(network)$degree)]
vertex_attr(network, "1564")
V(network)[V(network)$degree == which.min(V(network)$degree)]
vertex_attr(network)
data.v
data.v[name == V(network)[V(network)$degree == which.min(V(network)$degree)]]
V(network)[V(network)$degree == which.min(V(network)$degree)]
V(network)[V(network)$degree == which.min(V(network)$degree)]$name
data.v[name == V(network)[V(network)$degree == which.min(V(network)$degree)]$name]
data.v
data %>% filter(name == V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
data %>% filter(name == V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
V(network)[V(network)$degree == which.min(V(network)$degree)]$name
data %>% filter(name == "1564")
data.v %>% filter(name == "1564")
data.v %>% filter(name == V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
data.v %>% filter(name %in% V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
data.v
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
edges <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
edges
network <- graph_from_data_frame(edges, directed=FALSE, vertices=data2)
vertices <- as_data_frame(network, what="vertices")
get.edgelist(network)
vertices <- as_data_frame(network, what="vertices")
vertices <- igraph::as_data_frame(network, what="vertices")
vertices
library(dplyr)
library(igraph)
library(tidyr)
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
edges <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
network <- graph_from_data_frame(edges, directed=FALSE, vertices=data2)
network
V(network)$sex[V(network)$sex == "Unknown"] <- NA
V(network)$sex[1:50]
V(network)$class[1:50]
E(network)$Freq[1:50]
is_connected(network)
V(network)$degree <- degree(network)
V(network)$degree[1:50]
print(paste("Mean of sample:", mean(V(network)$degree)))
print(paste("Variance of sample:", var(V(network)$degree)))
print(paste("Median of sample:", median(V(network)$degree)))
print(paste("Min of sample:", min(V(network)$degree)))
print(paste("Max of sample:", max(V(network)$degree)))
vertices <- igraph::as_data_frame(network, what="vertices")
vertices
vertices %>%
ggplot(aes(x=degree)) +
geom_histogram(aes(y=..density..))
library(nortest)
print(paste("Pearson", pearson.test(vertices$degree)$p))
print(paste("Lilliefors", lillie.test(vertices$degree)$p))
print(paste("Anderson.Darling", ad.test(vertices$degree)$p))
print(paste("Shapiro.Wilk", shapiro.test(vertices$degree)$p))
count.of.teachers <- vertices %>% filter(class == "Teachers") %>% nrow()
(vertices %>% arrange(-degree))[1:count.of.teachers,]
library(dplyr)
library(igraph)
library(tidyr)
data1 <- read.csv("primaryschool.csv", sep="\t", header=FALSE)
colnames(data1) <- c("time", "i", "j", "classi", "classj")
data2 <- read.csv("metadata_primaryschool.txt", sep="\t", header=FALSE)
colnames(data2) <- c("i", "class", "sex")
data1 <- data.frame(table(data1 %>% dplyr::select(i, j))) %>%
filter(Freq > 0)
network <- graph_from_data_frame(data1, directed=FALSE, vertices=data2)
network
V(network)$sex[V(network)$sex == "Unknown"] <- NA
V(network)$sex[1:50]
V(network)$class[1:50]
E(network)$Freq[1:50]
is_connected(network)
V(network)$degree <- degree(network)
V(network)$degree[1:50]
print(paste("Mean of sample:", mean(V(network)$degree)))
print(paste("Variance of sample:", var(V(network)$degree)))
print(paste("Median of sample:", median(V(network)$degree)))
print(paste("Min of sample:", min(V(network)$degree)))
print(paste("Max of sample:", max(V(network)$degree)))
library(ggplot2)
vertices <- igraph::as_data_frame(network, what="vertices")
vertices %>%
ggplot(aes(x=degree)) +
geom_histogram(aes(y=..density..))
library(nortest)
print(paste("Pearson", pearson.test(vertices$degree)$p))
print(paste("Lilliefors", lillie.test(vertices$degree)$p))
print(paste("Anderson.Darling", ad.test(vertices$degree)$p))
print(paste("Shapiro.Wilk", shapiro.test(vertices$degree)$p))
count.of.teachers <- vertices %>% filter(class == "Teachers") %>% nrow()
(vertices %>% arrange(-degree))[1:count.of.teachers,]
edge_density(network)
class <- unique(V(network)$class)
for(i in class) {
subgraph <- induced_subgraph(network, V(network)[class == i])
print(paste("density of", i, ":", edge_density(subgraph)))
}
edges <- as_long_data_frame(network) %>%
mutate(from = as.character(from), to = as.character(to))
tmp <- data.frame(to = edges$from, from = edges$to, Freq = edges$Freq,
to_class = edges$from_class, from_class = edges$to_class)
tmp <- rbind(edges %>% select(from, to, Freq, to_class, from_class), tmp)
tmp %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
tmp %>% filter(from_class == "4B", to_class == "4B") %>%
ggplot(aes(from, to)) +
geom_raster(aes(fill=Freq)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
theme(legend.position="none") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_blank())
V(network)$transitivity <- transitivity(network, type="local")
V(network)$transitivity[1:50]
vertices$transitivity <- V(network)$transitivity
(vertices %>% arrange(-transitivity))[1:10,]
library(reshape)
data.prob <- edges %>%
dplyr::select(from_degree, to_degree) %>%
table() %>%
data.frame() %>%
mutate(Freq = Freq / sum(Freq)) %>%
dplyr::rename(probability = Freq) %>%
filter(probability > 0)
tmp <- data.frame(from_degree = data.prob$to_degree,
to_degree = data.prob$from_degree,
probability = data.prob$probability)
tmp <- rbind(data.prob, tmp)
tmp %>%
ggplot(aes(from_degree, to_degree)) +
geom_raster(aes(fill = probability)) +
scale_fill_gradient2(low="gray100", mid="gray50", high="gray0") +
scale_x_discrete(breaks=seq(20, 134, 5)) +
scale_y_discrete(breaks=seq(20, 134, 5)) +
theme(panel.background = element_blank())
vertices %>% filter(name %in% V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
vertices %>% filter(name %in% V(network)[V(network)$degree == which.min(V(network)$degree)]$name)
which.min(V(network)$degree
which.min(V(network)$degree
which.min(V(network)$degree)
V(network)[78]
vertices[78,]
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers", "1A")]$name),
layout=layout_in_circle)
igraph_options(vertex.label=name)
plot(subgraph(network, V(network)[V(network)$class %in% c("Teachers")]$name),
layout=layout_in_circle)
(vertices %>% arrange(-degree))[1:10,]
(vertices %>% arrange(degree))[1:10,]
(vertices %>% arrange(degree))[1:10,]$name
plot(subgraph(network, (vertices %>% arrange(degree))[1:10,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:20,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% arrange(degree))[1:50,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:50,]$name),
layout=layout_in_circle)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=3, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:40,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.5)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=0.9)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA,
edge.arrow.size=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=1)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=2)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA, edge.size=20)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=10, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
igraph_options(vertex.size=5, vertex.label=NA)
plot(subgraph(network, (vertices %>% filter(class != "Teachers") %>% arrange(degree))[1:30,]$name),
layout=layout_in_circle)
